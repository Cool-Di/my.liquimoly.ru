function show_fasovka(nom, p_id, link) {    link.hide();    $.ajax({        method: "POST",        url: "/index.php/ajax/getfasovki",        data: {nom: nom, code: p_id}    }).done(function (data) {        var pr_str = '';        var av;        i = 0;        for (i = 0; i <= data.products.length - 1; i++) {            type = data.products[i].quantity_name;            type_str = 'л';            switch( type )                {                case 'mass':                    type_str = 'кг';                    break;                case 'number':                    data.products[i].volume = 1;                    type_str = 'шт.';                    break;                }            pr_str += '<div style="clear: both;"></div>';            pr_str += '<div class="p_info">';            pr_str += '<p>Артикул: <b><a href="/index.php/catalog/item/' + data.products[i].code_url + '">' + data.products[i].code + '</a></b>, фасовка: <b>' + parseFloat(data.products[i].volume) + ' ' + type_str + '</b>, в упаковке: <b>' + data.products[i].quantity_packing + ' шт.</b><br />';            av = '<span style="color: #F7AC11">нет данных</span>';            switch ( parseInt(data.products[i].av) )                {                case 0:                    av = '<span style="color: #F40000">нет на складе' + (data.products[i].av_date !== '00.00.0000'?' до ' + data.products[i].av_date:'') + '</span>';                    break;                case 1:                    av = '<span style="color: #F7AC11">мало</span>';                    break;                case 2:                    av = '<span style="color: #52A350">много</span>';                    break;                }            pr_str += 'Наличие на складе: <b>' + av + '</b></p>';            pr_str += '</div>';            pr_str += '<div class="p_order">';            pr_str += '<p>Цена: <b>';            if ( data.products[i].RetailPrice == null )                {                pr_str += 'по запросу';                }            else                {                pr_str += data.products[i].RetailPrice + ' руб.';                }            pr_str += '</b>';            in_b = data.products[i].in_basket ? data.products[i].in_basket : 1 ;            if ( !(parseInt(data.products[i].av) === 0 && data.unit === true) )                {                pr_str += '<input id="count_' + data.products[i].code + '" class="p_count" name="count" type="number" value="' + in_b + '">шт. <input onclick="AddBasket(\'' + data.products[i].code + '\', $( document.getElementById(\'count_' + data.products[i].code + '\') ).val());" type="submit" value="В корзину"></p>';                }            pr_str += '</div>';        }        $('#fasovka_' + p_id).html(pr_str);    });}